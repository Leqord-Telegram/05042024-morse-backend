use ydb::{ClientBuilder, Query, StaticToken, YdbResult};
use ydb::ServiceAccountCredentials;


let ydb_url = env::var("YDB_URL").unwrap();

    println!("Connecting to {}", ydb_url);

    let client = ClientBuilder::new_from_connection_string(ydb_url).unwrap()
        .with_credentials(ServiceAccountCredentials::from_env().unwrap())
        .client().unwrap();
    client.wait().await.unwrap();

    println!("Client connected");

    let sum: i32 = client
        .table_client()
        .retry_transaction(|mut t| async move {
            let res = t.query(Query::from("SELECT 1 + 1 AS sum")).await?;
            let field_val: i32 = res.into_only_row()?.remove_field_by_name("sum")?.try_into()?;
            return Ok(field_val);
        })
        .await.unwrap();

    println!("sum: {}", sum);